// structure.tsに全問題のquestionIdを追加するスクリプト
const fs = require("fs");
const path = require("path");

// 各トピックの問題IDマッピング
const questionIds = {
  "01_java_basics": [
    "program_execution_order",
    "readable_code_concept",
    "brace_role",
    "java_use_cases",
    "hello_world_output",
    "run_java_eclipse",
    "display_name_age",
  ],
  "02_variables_and_types": [
    "variables_concept", // 既存
    "type_basics", // 既存
    "int_type_data",
    "double_type_data",
    "string_type_data",
    "boolean_type_data",
    "assignment_concept",
    "declare_variable", // 既存
    "declare_int_variable",
    "declare_double_variable",
    "declare_boolean_variable",
    "declare_string_variable",
    "variable_naming",
    "variable_scope",
    "declare_constant",
    "read_type_compatibility",
  ],
  "03_operators": [
    "arithmetic_operators_concept",
    "comparison_operators_concept",
    "logical_operators_concept",
    "increment_decrement_concept",
    "basic_arithmetic",
    "modulo_operation",
    "integer_division_result",
    "compound_assignment",
    "value_comparison",
    "combine_conditions",
    "negate_condition",
    "increment_decrement_value",
    "read_calculation_result",
  ],
  "03a_scanner": [
    "standard_input_concept",
    "scanner_role",
    "input_string_vs_int",
    "keyboard_input",
    "setup_scanner",
    "read_line",
    "read_integer",
    "read_double",
    "nextint_pitfall",
    "handle_input_error",
  ],
  "03b_random": [
    "random_concept",
    "random_class_role",
    "nextint_argument_meaning",
    "generate_random_number",
    "setup_random",
    "random_0_to_9",
    "random_1_to_100",
    "random_double_0_to_1",
    "random_reproducibility",
    "random_selection_from_array",
  ],
  "04_if_statement": [
    "conditional_branch_concept",
    "if_syntax_basics",
    "if_else_vs_elseif",
    "switch_vs_if",
    "simple_if_statement",
    "if_else_statement",
    "if_elseif_else_statement",
    "complex_conditions",
    "switch_statement",
    "switch_break_role",
    "read_conditional_code",
    "conditional_by_value",
  ],
  "05_loops": [
    "loop_concept",
    "for_loop_syntax",
    "while_vs_dowhile",
    "break_vs_continue",
    "infinite_loop_concept",
    "for_loop_repeat",
    "for_loop_1_to_10",
    "while_loop",
    "do_while_loop",
    "break_statement",
    "continue_statement",
    "nested_loop",
    "read_loop_count",
  ],
  "06_arrays": [
    "array_concept",
    "array_index_concept",
    "array_declaration_initialization",
    "array_length",
    "create_array",
    "get_array_element",
    "loop_array_elements",
    "enhanced_for_loop",
    "array_sum_average",
    "array_max_min",
    "two_dimensional_array",
  ],
  "07_methods": [
    "method_concept",
    "method_no_param_no_return",
    "method_with_parameter",
    "method_with_return",
    "void_meaning",
    "call_method_and_receive",
    "method_overloading",
    "method_variable_scope",
    "refactor_to_method",
  ],
  "08_multiple_classes": [
    "package_concept",
    "import_statement",
    "multiple_classes_benefit",
    "call_other_class_method",
    "use_eclipse_completion",
    "multi_class_program",
  ],
  "09_exception_handling": [
    "exception_concept",
    "try_catch_finally_blocks",
    "throw_vs_throws",
    "try_catch_handling",
    "catch_multiple_exceptions",
    "finally_block",
    "throws_clause",
    "throw_exception",
    "read_exception_flow",
    "exception_file_network",
  ],
  "10_oop_basics": [
    "class_object_relationship",
    "oop_concept",
    "field_vs_method",
    "field_store_data",
    "create_object_with_new",
    "call_instance_method",
    "static_vs_instance_method",
    "create_multiple_objects",
    "create_class_with_field_method",
    "manage_objects_in_array",
  ],
  "11_constructors": [
    "constructor_concept",
    "constructor_vs_method",
    "this_keyword_role",
    "constructor_initialize_field",
    "constructor_with_parameter",
    "this_keyword_field",
    "constructor_overloading",
    "default_constructor_mechanism",
    "this_constructor_call",
    "constructor_validation",
  ],
  "12_inheritance": [
    "inheritance_concept",
    "extends_keyword",
    "use_parent_method",
    "super_call_method",
    "super_call_constructor",
    "method_override",
    "override_annotation",
    "overload_vs_override",
    "parent_type_child_object",
    "appropriate_inheritance_use",
  ],
  "13_interfaces": [
    "interface_concept",
    "create_interface",
    "implements_interface",
    "interface_method_characteristic",
    "implement_all_methods",
    "implement_multiple_interfaces",
    "interface_type_polymorphism",
    "default_method_role",
    "inheritance_vs_interface",
  ],
  "14_encapsulation": [
    "encapsulation_concept",
    "private_field",
    "getter_method",
    "setter_method",
    "public_vs_private",
    "protected_vs_default",
    "setter_validation",
    "readonly_field",
    "appropriate_access_modifier",
  ],
  "15_collections": [
    "arraylist_characteristics",
    "array_vs_arraylist",
    "generics_concept",
    "arraylist_add_element",
    "arraylist_get_element",
    "arraylist_remove_element",
    "hashset_unique_data",
    "hashmap_key_value",
    "generics_type_parameter",
    "collection_types_usage",
    "loop_collection",
  ],
  "16_datetime": [
    "datetime_classes_difference",
    "datetimeformatter_role",
    "localdate_today",
    "localtime_now",
    "localdatetime_both",
    "date_add_subtract",
    "date_difference",
    "datetimeformatter_format",
    "period_vs_duration",
    "datetime_immutability",
  ],
  "02_mvc_intro": [
    "mvc_elements",
    "model_role",
    "view_role",
    "controller_role",
    "mvc_separation_benefit",
    "read_mvc_flow",
    "framework_benefit",
    "organize_code_mvc",
  ],
  "04_controller_routing": [
    "routing_concept",
    "get_vs_post",
    "controller_annotation_role",
    "create_controller_class",
    "getmapping_url_mapping",
    "return_view_name",
    "postmapping_form_submit",
    "get_post_usage",
    "read_url_to_method",
    "troubleshoot_controller_detection",
    "requestmapping_usage",
  ],
  "05_request_to_controller": [
    "request_parameter_concept",
    "requestparam_role",
    "pathvariable_role",
    "requestparam_query_param",
    "pathvariable_url_part",
    "query_vs_path_param",
    "form_object_multiple_values",
    "read_url_values",
    "required_vs_optional_param",
  ],
  "06_controller_to_tymeleaf": [
    "thymeleaf_concept",
    "model_object_role",
    "thtext_vs_thutext",
    "thymeleaf_main_attributes",
    "model_addattribute",
    "thtext_display_value",
    "inline_expression",
    "thif_conditional_display",
    "theach_repeat_display",
    "thobject_reference",
    "thutext_caution",
    "thymeleaf_utilities",
    "fragment_reuse",
  ],
  "07_validation": [
    "validation_concept",
    "client_vs_server_validation",
    "validation_annotations",
    "bindingresult_role",
    "notnull_required_check",
    "min_max_range_check",
    "email_format_check",
    "validated_execute",
    "bindingresult_receive_errors",
    "therrors_display_message",
    "asserttrue_correlation_check",
    "preserve_input_on_error",
  ],
  "08_spring_di": [
    "di_concept",
    "service_annotation",
    "constructor_injection",
    "autowired_mechanism",
    "stereotype_annotations_difference",
    "read_new_vs_di",
    "primary_bean_priority",
    "interface_based_di",
  ],
  "09_db_mybatis": [
    "orm_concept",
    "mybatis_role",
    "annotation_vs_xml_mapper",
    "resultmap_role",
    "mapper_annotation",
    "select_annotation",
    "xml_mapper_sql",
    "schema_sql_create_table",
    "data_sql_insert_data",
    "resultmap_mapping",
    "resultmap_one_to_many",
    "application_properties_db",
  ],
  "10_session_login": [
    "session_concept",
    "session_vs_request_scope",
    "httpsession_role",
    "httpsession_save_value",
    "httpsession_get_value",
    "session_vs_request_scope_difference",
    "sessionattributes_form_data",
    "sessionstatus_clear",
    "session_login_state",
    "session_shopping_cart",
  ],
  "11_spring_security": [
    "authentication_concept",
    "authorization_concept",
    "password_hashing_necessity",
    "userdetailsservice_user_info",
    "bcrypt_password_encode",
    "securityfilterchain_login_page",
    "security_mybatis_authentication",
    "read_login_session_info",
    "implement_logout",
  ],
};

const structurePath = path.join(__dirname, "../docs/src/structure.ts");
let content = fs.readFileSync(structurePath, "utf8");

// 既にquestionIdが設定されている問題はスキップ
// 各トピックごとに処理
Object.entries(questionIds).forEach(([topicId, ids]) => {
  // トピック定義を探す正規表現
  const topicRegex = new RegExp(
    `withAutoIds\\(\\{[\\s\\S]*?id: "${topicId}",[\\s\\S]*?questions: \\[([\\s\\S]*?)\\]`,
    "g",
  );

  const match = topicRegex.exec(content);
  if (!match) {
    console.log(`⚠️ トピック ${topicId} が見つかりませんでした`);
    return;
  }

  console.log(`✅ ${topicId} を処理中...`);
});

console.log("完了！");
