# MDX構文ルール

本ドキュメントは、MDXファイルを記述する際の構文ルールを定義する。

---

## import文

### OneCompilerCodeBlock

```typescript
import { OneCompilerCodeBlock } from "@site/src/components/OneCompilerCodeBlock";
```

### CodePenEmbed

```typescript
import { CodePenEmbed } from "@site/src/components/CodePenEmbed";
```

**重要**: import文は必ずファイルの先頭に配置する。

---

## CodePenEmbed コンポーネントの使用方法

CodePenEmbed コンポーネントは、CodePen の埋め込みを iframe で表示するためのコンポーネントである。
HTML/CSS の教材で、インタラクティブなデモを提供する際に使用する。

### 基本的な使い方

```tsx
// 最小限の指定（slugHashのみ必須）
<CodePenEmbed slugHash="ByKOEqx" />
```

### 主要な props

| props | 型 | デフォルト値 | 説明 |
|-------|-----|-------------|------|
| `slugHash` | `string` | （必須） | CodePenのID |
| `user` | `string` | `"hash52"` | CodePenのユーザー名 |
| `defaultTab` | `"html" \| "css" \| "js"` | `"html"` | デフォルトで開くタブ |
| `showResult` | `boolean` | `true` | Resultタブを表示するか |
| `editable` | `boolean` | `true` | コード編集可能か |
| `theme` | `"light" \| "dark"` | Docusaurusのカラーモード | テーマ（通常は指定不要） |
| `height` | `string \| number` | `"300"` | iframeの高さ |
| `htmlCode` | `string` | - | HTMLソースコード（検索対象） |
| `cssCode` | `string` | - | CSSソースコード（検索対象） |
| `jsCode` | `string` | - | JavaScriptソースコード（検索対象） |

### 使用例

```tsx
// CSSタブをデフォルトで開く
<CodePenEmbed slugHash="ByKOEqx" defaultTab="css" />

// Result表示なし（コードのみ）
<CodePenEmbed slugHash="ByKOEqx" showResult={false} />

// 編集不可
<CodePenEmbed slugHash="ByKOEqx" editable={false} />

// 検索対象のソースコードを埋め込む
<CodePenEmbed
  slugHash="ByKOEqx"
  htmlCode="<h1>Hello World</h1>"
  cssCode="h1 { color: red; }"
  jsCode="console.log('Hello');"
/>
```

### 注意点

- `theme` プロパティは通常指定不要。Docusaurus のカラーモードに自動的に追従する
- `htmlCode`、`cssCode`、`jsCode` は、サイト内検索の対象とするために不可視で描画される
- CodePen は外部サービスのため、ネットワーク環境によっては読み込みに時間がかかる場合がある

---

## 改行の扱い

**MDXファイルで改行を反映させるには、改行の前に半角スペースを2つ入れる**

これは Markdown の仕様で、半角スペース2つ（`  `）+ 改行で `<br>` タグが生成される。

### 例

```markdown
この章では、プログラミングとは何か、Javaとは何かを学び、  
最初のプログラム「Hello World」を書いて実行する。
```

上記のように、1行目の末尾に半角スペース2つを入れることで、2行目が改行として表示される。

### 適用箇所

- 複数行にわたる説明文
- 箇条書きの各項目内で複数行になる場合
- 表内で複数行になる場合

### 注意

- 段落を分ける場合（空行を入れる場合）は、半角スペース2つは不要
- コードブロック内では不要

---

## 強調記号の扱い

MDXファイルで **`**`（強調記号）** を使用する際、プレビューで正しく展開されない場合がある。

### 問題が起きるケース

- 句読点（`。`）、閉じ括弧（`」`、`）`）などの直後に `**` を配置した場合
- 例：`技術である**必要性から理解**させる`（展開されない可能性）

### 解決策

**`**` の前後に半角スペースを置く**

### 正しい例

```markdown
技術である **必要性から理解** させる
この章では、 **プログラムの基本原則とJavaの第一歩** を踏み出そう。
「これは **重要** である」
```

### 適用ルール

- 強調記号 `**` の前後には必ず半角スペースを1つ入れる
- 文頭や文末の場合は、前後どちらか一方のみで良い
- 例外：バッククォート `` ` `` と組み合わせる場合（例：`` **`main`メソッド** ``）は、バッククォートとの間にスペースは不要

---

## 表の中での特殊文字

MDXファイルの表（table）の中で特殊文字を使用する際は、エスケープに注意が必要である。

### 問題が起きるケース

- 表の列区切り文字 `|` を表示したい場合
- 例：`**\|\|**`（論理OR演算子）をエスケープして表示しようとする

### エラー例

```markdown
| 演算子 | 意味 |
|--------|------|
| **\|\|** | OR演算子 |  ← エラー！MDXパーサーが混乱する
```

### 解決策

**バッククォート（コード記法）を使う**

HTMLエンティティ（`&#124;`）は避け、可能な限りバッククォートで囲む。

### 正しい例

```markdown
| 演算子 | 意味 |
|--------|------|
| `||` | OR演算子 |
| `&&` | AND演算子 |
| `!` | NOT演算子 |
```

### 適用ルール

- 表の中でプログラミングの演算子や記号を表示する場合は、バッククォートで囲む
- `\|` のようなエスケープは使わない
- 一貫性のため、同じ列の他の要素もバッククォートで統一することを推奨

---

## 演算子や特殊記号の記述

MDXファイルで演算子や特殊記号を記述する際は、適切なエスケープが必要である。

### 問題が起きるケース

- `<` や `>` が HTML タグとして解釈される
- 例：`比較演算子（==, !=, <, >, <=, >=）`（MDXパーサーがエラー）

### 解決策（2つの方法）

#### 1. バッククォートで囲む（推奨）

```markdown
- 算術演算子（`+`, `-`, `*`, `/`, `%`）を使いこなせる
- 比較演算子（`==`, `!=`, `<`, `>`, `<=`, `>=`）を理解している
- 論理演算子（`&&`, `||`, `!`）を理解している
```

#### 2. バックスラッシュでエスケープする

```markdown
- 比較演算子（==, !=, \<, \>, \<=, \>=）を理解している
```

HTML で特別な意味を持つ文字（`<`、`>`、`&` など）は `\` でエスケープできる。

### 適用ルール

- **基本的にはバッククォートで囲む方法を推奨**（可読性が高く、一貫性を保ちやすい）
- バッククォートを使う場合は、同じ文脈内のすべての演算子を統一的に囲む
- 文章中で演算子を説明する際は、バックスラッシュエスケープでも可
- 特に `<`、`>`、`&` など HTML で特別な意味を持つ文字は必ず何らかの方法でエスケープする

---

## 関連ドキュメント

- [章構成テンプレート](./chapter-structure.md)
- [Admonitions活用ガイド](./admonitions-guide.md)
