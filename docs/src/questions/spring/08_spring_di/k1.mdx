# Springã®DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ â€” æ¼”ç¿’å•é¡Œ

---

## ğŸ§  KNOWï¼ˆçŸ¥è­˜ç¢ºèªï¼‰

### KNOW-1ï¼šDIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã®ç›®çš„ã¨ä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã„ã‚‹ï¼ˆç©´åŸ‹ã‚ï¼‰

**å•é¡Œï¼š**  
æ¬¡ã®æ–‡ã®ï¼ˆAï¼‰ï¼ˆBï¼‰ã‚’åŸ‹ã‚ã‚ˆã€‚

> DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã¨ã¯ã€ã‚¯ãƒ©ã‚¹ãŒå¿…è¦ã¨ã™ã‚‹ä»–ã®ã‚¯ãƒ©ã‚¹ï¼ˆï¼ˆAï¼‰ï¼‰ã‚’ã€  
> è‡ªåˆ†ã§ `new` ã›ãšã«ï¼ˆï¼ˆBï¼‰ï¼‰ãŒç”Ÿæˆãƒ»æ³¨å…¥ã—ã¦ãã‚Œã‚‹ä»•çµ„ã¿ã§ã‚ã‚‹ã€‚

**å›ç­”ï¼š**  
- ï¼ˆAï¼‰ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆä¾å­˜ã‚¯ãƒ©ã‚¹ï¼‰  
- ï¼ˆBï¼‰Springãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆDIã‚³ãƒ³ãƒ†ãƒŠï¼‰

**è§£èª¬ï¼š**  
DIã§ã¯ã€å¿…è¦ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è‡ªåˆ†ã§ä½œã‚‰ãšã€SpringãŒç®¡ç†ãƒ»æ³¨å…¥ã™ã‚‹ã€‚  
ã“ã‚Œã«ã‚ˆã‚Šä¾å­˜é–¢ä¿‚ãŒç–çµåˆã«ãªã‚Šã€ä¿®æ­£ã‚„ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“ã«ãªã‚‹ã€‚

---

### KNOW-2ï¼š@Controller / @Service / @Repository / @Component ã®å½¹å‰²ã‚’åŒºåˆ¥ã§ãã‚‹

**å•é¡Œï¼š**  
æ¬¡ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®å½¹å‰²ã‚’ç°¡æ½”ã«èª¬æ˜ã›ã‚ˆã€‚  

| ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|----------------|------|
| @Controller |  |
| @Service |  |
| @Repository |  |
| @Component |  |

**å›ç­”ï¼š**  

| ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|----------------|------|
| @Controller | Webãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹ã‚¯ãƒ©ã‚¹ï¼ˆç”»é¢åˆ¶å¾¡ï¼‰ |
| @Service | ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¨˜è¿°ã™ã‚‹ã‚¯ãƒ©ã‚¹ |
| @Repository | DBã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‹…å½“ã™ã‚‹ã‚¯ãƒ©ã‚¹ |
| @Component | ãã®ä»–ã®æ±ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãªã©ï¼‰ |

**è§£èª¬ï¼š**  
Springã¯èµ·å‹•æ™‚ã«ã“ã‚Œã‚‰ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€è‡ªå‹•çš„ã«Beanã‚’ç™»éŒ²ã™ã‚‹ã€‚  
å½¹å‰²ã”ã¨ã«ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ†ã‘ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®è²¬å‹™ãŒæ˜ç¢ºã«ãªã‚‹ã€‚

---

### KNOW-3ï¼šã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿ã‚’èª¬æ˜ã§ãã‚‹

**å•é¡Œï¼š**  
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã§ã€`GreetingService` ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã©ã®ã‚ˆã†ã« `GreetingController` ã«æ¸¡ã•ã‚Œã‚‹ã‹èª¬æ˜ã›ã‚ˆã€‚

```java
@Controller
public class GreetingController {
    private final GreetingService service;

    @Autowired
    public GreetingController(GreetingService service) {
        this.service = service;
    }
}
```

**å›ç­”ï¼š**  
SpringãŒDIã‚³ãƒ³ãƒ†ãƒŠã§ç®¡ç†ã—ã¦ã„ã‚‹ `GreetingService` ã®Beanã‚’æ¢ã—ã€  
ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã«è‡ªå‹•çš„ã«æ¸¡ã™ï¼ˆæ³¨å…¥ã™ã‚‹ï¼‰ã€‚

**è§£èª¬ï¼š**  
`@Autowired` ã‚’ä»˜ã‘ã‚‹ã¨ã€Springã¯åŒå‹ã®Beanã‚’è‡ªå‹•ã§è¦‹ã¤ã‘ã¦æ³¨å…¥ã™ã‚‹ã€‚  
ã“ã‚Œã‚’ã€Œã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã€ã¨å‘¼ã¶ã€‚

---

## ğŸ‘€ READï¼ˆã‚³ãƒ¼ãƒ‰ç†è§£ï¼‰

### READ-1ï¼š@Autowired ã®æŒ™å‹•ã¨ä¾å­˜é–¢ä¿‚è§£æ±ºã®æµã‚Œã‚’ç†è§£ã—ã¦ã„ã‚‹

**å•é¡Œï¼š**  
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ã€SpringãŒã©ã®ã‚ˆã†ã«ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã—ã¦ã„ã‚‹ã‹èª¬æ˜ã›ã‚ˆã€‚

```java
@Service
public class GreetingService {
    public String getMessage() { return "ã“ã‚“ã«ã¡ã¯ï¼"; }
}

@Controller
public class GreetingController {
    private final GreetingService service;

    @Autowired
    public GreetingController(GreetingService service) {
        this.service = service;
    }
}
```

**å›ç­”ï¼š**  
`@Service` ãŒä»˜ã„ãŸ `GreetingService` ãŒBeanã¨ã—ã¦ç™»éŒ²ã•ã‚Œã€  
`@Autowired` ã«ã‚ˆã‚Šãã®BeanãŒ `GreetingController` ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ³¨å…¥ã•ã‚Œã‚‹ã€‚

**è§£èª¬ï¼š**  
Springã¯èµ·å‹•æ™‚ã« `@Service` ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦BeanåŒ–ã—ã€  
ä¾å­˜å…ˆã‚’è¦æ±‚ã™ã‚‹ã‚¯ãƒ©ã‚¹ã«è‡ªå‹•çš„ã«æ¸¡ã™ã“ã¨ã§ä¾å­˜ã‚’è§£æ±ºã™ã‚‹ã€‚

---

### READ-2ï¼šè‡ªåˆ†ã§ new ã™ã‚‹ã‚±ãƒ¼ã‚¹ã¨DIã«ä»»ã›ã‚‹ã‚±ãƒ¼ã‚¹ã‚’åˆ¤æ–­ã§ãã‚‹

**å•é¡Œï¼š**  
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã®ã†ã¡ã€Springã®DIã«ä»»ã›ã‚‹ã¹ãã‚‚ã®ã‚’ã™ã¹ã¦é¸ã¹ã€‚

```java
List<String> names = new ArrayList<>();
User user = new User("Taro", 20);
UserService userService = new UserService();
EmailSender emailSender = new EmailSender();
```

**å›ç­”ï¼š**  
`UserService` ã¨ `EmailSender`

**è§£èª¬ï¼š**  
ã“ã‚Œã‚‰ã¯ã‚¢ãƒ—ãƒªå…¨ä½“ã§åˆ©ç”¨ã•ã‚Œã‚‹æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã‚„éƒ¨å“ã§ã‚ã‚Šã€  
ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã‚’Springã«ä»»ã›ã‚‹æ–¹ãŒä¿å®ˆæ€§ãŒé«˜ã„ã€‚  
ä¸€æ–¹ã€`List` ã‚„ `User` ã®ã‚ˆã†ãªä¸€æ™‚çš„ãƒ‡ãƒ¼ã‚¿ã¯è‡ªåˆ†ã§ `new` ã—ã¦ã‚ˆã„ã€‚

---

### READ-3ï¼š@Primary ã«ã‚ˆã‚‹Beanã®å„ªå…ˆé¸æŠã‚’ç†è§£ã—ã¦ã„ã‚‹

**å•é¡Œï¼š**  
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã§ã€SpringãŒã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ³¨å…¥ã™ã‚‹ã‹ç­”ãˆã‚ˆã€‚

```java
public interface GreetingService {
    String getMessage();
}

@Service
@Primary
public class FormalGreetingService implements GreetingService {
    public String getMessage() { return "ã“ã‚“ã«ã¡ã¯ã€‚"; }
}

@Service
public class CasualGreetingService implements GreetingService {
    public String getMessage() { return "ã‚„ã£ã»ãƒ¼ï¼"; }
}
```

**å›ç­”ï¼š**  
`FormalGreetingService`

**è§£èª¬ï¼š**  
`@Primary` ãŒä»˜ä¸ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ãŒå„ªå…ˆçš„ã«é¸ã°ã‚Œã‚‹ã€‚  
è¤‡æ•°ã®å®Ÿè£…ãŒã‚ã‚‹å ´åˆã€Springã¯ `@Primary` ã‚’åŸºæº–ã«æ³¨å…¥å¯¾è±¡ã‚’æ±ºå®šã™ã‚‹ã€‚

---

## âœï¸ WRITEï¼ˆå®Ÿè£…ï¼‰

### WRITE-1ï¼š@Service ã‚¯ãƒ©ã‚¹ã‚’DIã§åˆ©ç”¨ã™ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’å®Ÿè£…ã§ãã‚‹

**å•é¡Œï¼š**  
`MessageService` ã‚¯ãƒ©ã‚¹ã‚’ `@Service` ã¨ã—ã¦å®šç¾©ã—ã€  
ãã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ“ãƒ¥ãƒ¼ã«æ¸¡ã™ `MessageController` ã‚’ä½œæˆã›ã‚ˆã€‚

**å›ç­”ï¼š**

```java
// MessageService.java
@Service
public class MessageService {
    public String getMessage() {
        return "Hello from DI!";
    }
}

// MessageController.java
@Controller
public class MessageController {
    private final MessageService messageService;

    @Autowired
    public MessageController(MessageService messageService) {
        this.messageService = messageService;
    }

    @GetMapping("/message")
    public String showMessage(Model model) {
        model.addAttribute("msg", messageService.getMessage());
        return "message";
    }
}
```

**è§£èª¬ï¼š**  
`@Service` ã«ã‚ˆã‚Š `MessageService` ãŒBeanã¨ã—ã¦ç™»éŒ²ã•ã‚Œã€  
`@Autowired` ã«ã‚ˆã£ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¸è‡ªå‹•æ³¨å…¥ã•ã‚Œã‚‹ã€‚  
çµæœã¨ã—ã¦ã€`/message` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ `"Hello from DI!"` ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

---

### WRITE-2ï¼šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨è¤‡æ•°å®Ÿè£…ã‚’ç”¨ã„ã¦DIã§åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹æ§‹æˆã‚’å®Ÿè£…ã§ãã‚‹

**å•é¡Œï¼š**  
`GreetingService` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã€  
`FormalGreetingService` / `CasualGreetingService` ã®2å®Ÿè£…ã‚’ä½œæˆã›ã‚ˆã€‚  
`FormalGreetingService` ã‚’å„ªå…ˆçš„ã«ä½¿ç”¨ã—ã€  
ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©å´ã§ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã™ã‚‹ã‚ˆã†ã«ã›ã‚ˆã€‚

**å›ç­”ï¼š**

```java
// GreetingService.java
public interface GreetingService {
    String getMessage();
}

// FormalGreetingService.java
@Service
@Primary
public class FormalGreetingService implements GreetingService {
    public String getMessage() {
        return "ã“ã‚“ã«ã¡ã¯ã€‚ã”æ¥è¨ªã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚";
    }
}

// CasualGreetingService.java
@Service
public class CasualGreetingService implements GreetingService {
    public String getMessage() {
        return "ã‚„ã£ã»ãƒ¼ï¼";
    }
}

// GreetingController.java
@Controller
public class GreetingController {
    private final GreetingService service;

    @Autowired
    public GreetingController(GreetingService service) {
        this.service = service;
    }

    @GetMapping("/greet")
    public String greet(Model model) {
        model.addAttribute("msg", service.getMessage());
        return "greet";
    }
}
```

**è§£èª¬ï¼š**  
`@Primary` ã«ã‚ˆã‚Š `FormalGreetingService` ãŒå„ªå…ˆæ³¨å…¥ã•ã‚Œã‚‹ã€‚  
`GreetingController` ã¯ `GreetingService` ã«ã®ã¿ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã€  
å®Ÿè£…ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã‚‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®å¤‰æ›´ã¯ä¸è¦ã¨ãªã‚‹ã€‚  
ã“ã‚ŒãŒDIã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆã®æœ€å¤§ã®åˆ©ç‚¹ã§ã‚ã‚‹ã€‚
